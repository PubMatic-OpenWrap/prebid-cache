package metricstest

import (
	"github.com/PubMatic-OpenWrap/prebid-cache/metrics"
	"testing"
)

// metricstest contains utilities for testing metrics. These should only be imported into *_test.go files, and
// should not be used by live code.

func AssertSuccessMetricsExist(t *testing.T, entry *metrics.MetricsEntry) {
	t.Helper()
	if entry.Request.Count() != 1 {
		t.Errorf("The request should have been counted.")
	}
	if entry.Duration.Count() != 1 {
		t.Errorf("The request duration should have been counted.")
	}
	if entry.BadRequest.Count() != 0 {
		t.Errorf("No Bad requests should have been counted.")
	}
	if entry.Errors.Count() != 0 {
		t.Errorf("No Errors should have been counted.")
	}
}

func AssertErrorMetricsExist(t *testing.T, entry *metrics.MetricsEntry) {
	t.Helper()
	if entry.Request.Count() != 1 {
		t.Errorf("The request should have been counted.")
	}
	if entry.Duration.Count() != 0 {
		t.Errorf("The request duration should not have been counted.")
	}
	if entry.BadRequest.Count() != 0 {
		t.Errorf("No Bad requests should have been counted.")
	}
	if entry.Errors.Count() != 1 {
		t.Errorf("An Error should have been counted.")
	}
}
